defaults:
  - dit_b

name: "SSM-B"
attn_type: "ssm"
ssm_expansion: 1
attn_kwargs:
  d_expansion: 1
  d_state: 256

# For memory efficiency
grad_checkpoint: True 
scan_blocks: True 
scan_remat: True 
scan_remat_block_size: 4
dit_block_kwargs:
  grad_checkpoint_attn: True 
  grad_checkpoint_mlp: True 
  grad_checkpoint_adamlp: True 
  blockwise_mlp: False 
  blockwise_mlp_chunk_size: 128
  # Mixed precision
  mlp_dtype: "bfloat16"
  adaln_mlp_dtype: "bfloat16"
